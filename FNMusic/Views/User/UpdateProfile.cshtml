@model FNMusic.Models.EditProfile
@using FNMusic.Controllers;
@using Microsoft.AspNetCore.Http;
@using BaseLib.Models;
@using BaseLib.Utils;
@using UserMgt.Models;
@using UserMgt.Utils;
@using System.ComponentModel;
@using Microsoft.AspNetCore.Mvc.Rendering;
@inject IHttpContextAccessor HttpContextAccessor;

@{
    ViewData["Title"] = "Update your Profile";
    Layout = "~/Views/Shared/_ModalLayout.cshtml";
    string dateOfBirth =
        Model.DateOfBirth.Year
        + "-" + (Model.DateOfBirth.Month > 9 ? Model.DateOfBirth.Month.ToString() : "0" + Model.DateOfBirth.Month.ToString() )
        + "-" + (Model.DateOfBirth.Day > 9 ? Model.DateOfBirth.Day.ToString() : "0" + Model.DateOfBirth.Day.ToString() );

    List<SelectListItem> privacy = new List<SelectListItem>();
    for (int i = 0; i < 5; i++)
    {
        privacy.Add(new SelectListItem { Text =  EnumUtils<Privacy>.GetEnumDefaultPropertyValue(i), Value = i.ToString() });
    }

    List<SelectListItem> genres = new List<SelectListItem>
    {
        new SelectListItem { Value = "Select Genre",}
    };

    foreach (string genre in AppUtils.GetGenres())
    {
        if (genre == Model.Genre)
        {
            genres.Add(new SelectListItem() { Text = genre, Value = genre, Selected = true });
        }
        else
        {
            genres.Add(new SelectListItem() { Text = genre, Value = genre });
        }
    }
    string profileImage = !string.IsNullOrEmpty(Model.ProfileImagePath) ? Model.ProfileImagePath : "~/images/a0.png";
}
<section class="m-t-lg wrapper-md animated fadeInDown">
    <div class="container aside-xxl bg-white" style="box-shadow:0px 10px 10px; border-radius:5px;">
        <div id="editProfileBx" >
            <header class="modal-header">
                <h4>EDIT PROFILE</h4>
            </header>
            @using (Html.BeginForm("UpdateProfile", "User", FormMethod.Post, new { enctype = "multipart/form-data" }))
            {
                <section class="scrollable" style="height:400px; margin-top:2px;">
                    <div class="form-horizontal" style="padding: 10px 20px 10px 20px;">
                        <div class="form-group-sm">
                            <span class="text-sm">Name @Html.ValidationMessageFor(x => x.Name, "", new { @class = "text-danger" })</span>
                            <input name="Name" value="@Model.Name" class="form-control input-sm" maxlength="25" style="border-top:unset; border-left:unset; border-right:unset;" required />
                        </div>
                        <div class="form-group-sm" style="padding:5px 0px 0px 0px;">
                            <span class="text-sm">Biography @Html.ValidationMessageFor(x => x.Biography, "", new { @class = "text-danger" })</span>
                            @Html.TextAreaFor(x => x.Biography, new { @class = "form-control input-sm", style = "border-top:unset; border-left:unset; border-right:unset;" })
                        </div>
                        <div class="form-group-sm" style="padding:5px 0px 0px 0px;">
                            <span class="text-sm">Primary Genre @Html.ValidationMessageFor(x => x.Genre, "", new { @class = "text-danger" })</span>
                            @Html.DropDownListFor(x => x.Genre, genres, new { @class = "form-control input-sm", style = "border-top:unset; border-left:unset; border-right:unset;" })
                        </div>
                        <div class="form-group-sm" style="padding:5px 0px 0px 0px;">
                            <span class="text-sm">Location @Html.ValidationMessageFor(x => x.Location, "", new { @class = "text-danger" })</span>
                            @Html.TextBoxFor(x => x.Location, new { @class = "form-control input-sm", style = "border-top:unset; border-left:unset; border-right:unset;" })
                        </div>
                        <div class="form-group-sm" style="padding:5px 0px 0px 0px;">
                            <span class="text-sm">Website @Html.ValidationMessageFor(x => x.Website, "", new { @class = "text-danger" })</span>
                            @Html.TextBoxFor(x => x.Website, new { type = "url", @class = "form-control input-sm", style = "border-top:unset; border-left:unset; border-right:unset;" })
                        </div>
                        <div class="form-group-sm" style="padding:5px 0px 0px 0px">
                            <span class="text-sm">Date Of Birth @Html.ValidationMessageFor(x => x.DateOfBirth, "", new { @class = "text-danger" })</span>
                            <input name="DateOfBirth" type="date" class="form-control input-sm" value="@dateOfBirth" style="border-top:unset; border-left:unset; border-right:unset;" />
                        </div>
                        <h6 class="text-u-c">Privacy Options</h6>
                        <section class="form-group"  style="padding:5px 0px 0px 0px;">
                            <div class="form-group-sm">
                                <span class="text-sm col-sm-4">Month And Day @Html.ValidationMessageFor(x => x.MonthAndDay, "", new { @class = "text-danger" })</span>
                                <div class="col-sm-8">
                                    @Html.DropDownListFor(x => x.MonthAndDay, privacy, new { @class = "form-control text-sm", style = "border-top:unset; border-left:unset; border-right:unset;" })
                                </div>
                            </div>
                            <div class="form-group-sm">
                                <span class="text-sm col-sm-4">Year @Html.ValidationMessageFor(x => x.Year, "", new { @class = "text-danger" })</span>
                                <div class="col-sm-8">
                                    @Html.DropDownListFor(x => x.Year, privacy, new { @class = "form-control text-sm", style = "border-top:unset; border-left:unset; border-right:unset;" })
                                </div>
                            </div>
                        </section>
                        <div class="form-group-sm" style="padding:5px 0px 0px 0px;">
                            <span class="text-sm">Twitter Profile @Html.ValidationMessageFor(x => x.Twitter, "", new { @class = "text-danger" })</span>
                            @Html.TextBoxFor(x => x.Twitter, new { type = "url", @class = "form-control input-sm", style = "border-top:unset; border-left:unset; border-right:unset;" })
                        </div>
                        <div class="form-group-sm" style="padding:5px 0px 0px 0px;">
                            <span class="text-sm">Facebook Profile @Html.ValidationMessageFor(x => x.FaceBook, "", new { @class = "text-danger" })</span>
                            @Html.TextBoxFor(x => x.FaceBook, new { type = "url", @class = "form-control input-sm", style = "border-top:unset; border-left:unset; border-right:unset;" })
                        </div>
                        <div class="form-group-sm" style="padding:5px 0px 0px 0px;">
                            <span class="text-sm">Youtube Page @Html.ValidationMessageFor(x => x.Youtube, "", new { @class = "text-danger" })</span>
                            @Html.TextBoxFor(x => x.Youtube, new { type = "url", @class = "form-control input-sm", style = "border-top:unset; border-left:unset; border-right:unset;" })
                        </div>
                    </div>
                </section>
                <footer class="modal-footer">
                    <a class="btn btn-warning" data-dismiss="modal">
                        <span>Cancel</span>
                        <i class="fa fa-trash-o"></i>
                    </a>
                    <button type="submit" class="btn btn-success">
                        <span>Update</span>
                        <i class="fa fa-save"></i>
                    </button>
                </footer>
            }
        </div>
        <div id="editProfileImgBx" class="hidden">
            <header class="modal-header">
                <h4>EDIT PROFILE IMAGE</h4>
            </header>
            <link rel="stylesheet" href="~/css/croppie.css" type="text/css" />
            <script src="~/js/croppie.js"></script>
            <div class="imgCropBx"></div>
            <script>
                var el = $('imgCropBx');
                var resize = el.croppie({
                    viewport: {
                        height: 150,
                        width:150
                    }
                });
            </script>
            <footer class="modal-footer">
                <a class="btn btn-danger">
                    <span>Cancel</span>
                    <i class="icon-trash"></i>
                </a>
                <a class="btn btn-success" onclick="">
                    <span>Crop</span>
                    <i class="icon-crop"></i>
                </a>
            </footer>
            <div class="footer">
                <a class="text-center">
                    <small>Powered By Foliotek</small>
                </a>
            </div>
        </div>
    </div>
</section>